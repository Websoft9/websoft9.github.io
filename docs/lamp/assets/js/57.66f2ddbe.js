(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{196:function(t,a,r){"use strict";r.r(a);var e=r(0),s=Object(e.a)({},function(){var t=this,a=t.$createElement,r=t._self._c||a;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"安装网站"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#安装网站","aria-hidden":"true"}},[t._v("#")]),t._v(" 安装网站")]),t._v(" "),r("p",[t._v("在 LAMP 环境上安装一个网站，也就是我们常说的增加一个虚拟主机。")]),t._v(" "),r("p",[t._v("宏观上看，只需两个步骤："),r("strong",[t._v("上传网站代码")]),t._v(" + "),r("router-link",{attrs:{to:"/zh/stack-components.html#apache"}},[r("strong",[t._v("虚拟机主机配置文件")])]),t._v(" "),r("strong",[t._v("中增加 VirtualHost 配置段")])],1),t._v(" "),r("blockquote",[r("p",[t._v("VirtualHost 又称之为虚拟主机配置段，每个网站必定在 vhost.conf 中对应唯一的 VirtualHost。")])]),t._v(" "),r("h2",{attrs:{id:"准备"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#准备","aria-hidden":"true"}},[t._v("#")]),t._v(" 准备")]),t._v(" "),r("p",[t._v("安装网站之前，请了解如下几个要点，做好准备工作")]),t._v(" "),r("ul",[r("li",[t._v("虚拟机主机配置文件："),r("em",[t._v("/etc/httpd/vhost/vhost.conf")])]),t._v(" "),r("li",[t._v("连接工具：使用 WinSCP 连接服务器，它包含文件管理、运行命令两方面功能")]),t._v(" "),r("li",[t._v("域名：若需要使用域名，请确保备案后的域名成功解析到服务器IP")]),t._v(" "),r("li",[t._v("数据库：网站安装向导过程中可能需要使用数据库，请使用 "),r("router-link",{attrs:{to:"/zh/admin-mysql.html"}},[t._v("phpMyAdmin 管理数据库")])],1)]),t._v(" "),r("p",[t._v("有一个宏观认知之后，我们开始部署网站")]),t._v(" "),r("h2",{attrs:{id:"安装第一个网站"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#安装第一个网站","aria-hidden":"true"}},[t._v("#")]),t._v(" 安装第一个网站")]),t._v(" "),r("p",[t._v("下面通过"),r("strong",[t._v("替换示例网站")]),t._v("（LAMP 默认存在一个示例网站）的方式来教你安装你的第一个网站：")]),t._v(" "),r("ol",[r("li",[t._v("使用 WinSCP 连接服务器")]),t._v(" "),r("li",[t._v("删除示例网站 "),r("em",[t._v("/data/wwwroot/www.example.com")]),t._v(" 下的所有文件（保留目录）")]),t._v(" "),r("li",[t._v("将本地电脑上的网站源码上传到示例目录下\n"),r("img",{attrs:{src:"https://libs.websoft9.com/Websoft9/DocsPicture/zh/winscp/winscp-uploadcodestoexample-websoft9.png",alt:""}})]),t._v(" "),r("li",[t._v("修改 "),r("em",[t._v("vhost.conf")]),t._v(" 中已有 VirtualHost 配置段（"),r("router-link",{attrs:{to:"/zh/solution-deployment.html#virtualhost"}},[t._v("修改参考")]),t._v("），实现绑定域名、修改网站目录名称等操作。\n"),r("img",{attrs:{src:"https://libs.websoft9.com/Websoft9/DocsPicture/zh/lamp/lamp-editvhostconf-websoft9.png",alt:""}}),r("div",{staticClass:"warning custom-block"},[r("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),r("p",[t._v("如果不绑定域名、不修改网站目录名称，请跳过步骤4和5")])])],1),t._v(" "),r("li",[t._v("保存vhost.conf，然后在 WinSCP 中运行重启服务命令 或 云控制台重启服务器 ："),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v("# 重启Apache服务命令\nsystemctl restart httpd\n")])])])]),t._v(" "),r("li",[t._v("本地浏览器访问："),r("em",[t._v("http://域名")]),t._v(" 或 "),r("em",[t._v("http://服务器公网IP")]),t._v(" 即可访问您的网站")])]),t._v(" "),r("h2",{attrs:{id:"安装第二个网站"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#安装第二个网站","aria-hidden":"true"}},[t._v("#")]),t._v(" 安装第二个网站")]),t._v(" "),r("p",[t._v("从安装第二个网站开始，需要在"),r("em",[t._v("vhost.conf")]),t._v(" 中增加对应的虚拟主机配置段，具体如下")]),t._v(" "),r("ol",[r("li",[r("p",[t._v("使用 WinSCP 连接服务器，在 /data/wwwroot 下新建一个网站目录，假设命令为“mysite2”\n"),r("img",{attrs:{src:"https://libs.websoft9.com/Websoft9/DocsPicture/zh/lamp/lamp-createmysite2-websoft9.png",alt:""}})])]),t._v(" "),r("li",[r("p",[t._v("将本地网站源文件上传到："),r("em",[t._v("/data/wwwroot/mysite2")]),t._v(" "),r("img",{attrs:{src:"https://libs.websoft9.com/Websoft9/DocsPicture/zh/lamp/lamp-uploadcodes-websoft9.png",alt:""}})])]),t._v(" "),r("li",[r("p",[t._v("编辑 vhost.conf 文件\n"),r("img",{attrs:{src:"https://libs.websoft9.com/Websoft9/DocsPicture/zh/lamp/lamp-editvhostconf-websoft9.png",alt:""}})]),t._v(" "),r("p",[t._v("根据是否通过域名访问，选择下面操作之一：")]),t._v(" "),r("ul",[r("li",[r("strong",[t._v("有域名，通过 http://域名 访问网站")])])]),t._v(" "),r("p",[t._v("请将下面 VirtualHost 模板拷贝到 vhost.conf 中，并修改其中的ServerName, DocumentRoot, ErrorLog, CusomLog, Directory等项的值")]),t._v(" "),r("pre",[r("code",[t._v('```\n<VirtualHost *:80>\nServerName www.mydomain.com\n# ServerAlias other.mydomain.com\nDocumentRoot "/data/wwwroot/mysite2"\nErrorLog "/var/log/httpd/www.mydomain.com_error_apache.log"\nCustomLog "/var/log/httpd/www.mydomain.com_apache.log" common\n<Directory "/data/wwwroot/mysite2">\nOptions Indexes FollowSymlinks\nAllowOverride All\nRequire all granted\n</Directory>\n</VirtualHost>\n ```\n')])]),t._v(" "),r("ul",[r("li",[r("strong",[t._v("没有域名，通过 http://IP/mysite2 访问网站")])])]),t._v(" "),r("p",[t._v("请将下面 Alias 模板拷贝到 vhost.conf 中，并修改其中的 /path, Directory等项的值")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v('Alias /sitename /data/wwwroot/mysite2\n<Directory "/data/wwwroot/mysite2">\nOptions Indexes FollowSymlinks\nAllowOverride All\nRequire all granted\n</Directory>\n')])])])]),t._v(" "),r("li",[r("p",[t._v("保存vhost.conf，然后在 WinSCP 中运行重启服务命令 或 云控制台重启服务器 ：")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v("# 重启Apache服务命令\nsystemctl restart httpd\n")])])])]),t._v(" "),r("li",[r("p",[t._v("根据有无域名，本地浏览器访问：http://域名 或 http://IP/sitename  访问你的网站。")])])]),t._v(" "),r("h2",{attrs:{id:"安装第-n-个网站"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#安装第-n-个网站","aria-hidden":"true"}},[t._v("#")]),t._v(" 安装第 N 个网站")]),t._v(" "),r("p",[t._v("安装第n个网站与安装第二个网站的操作步骤一模一样")]),t._v(" "),r("p",[t._v("最后我们温故而知新，总结 LAMP 安装网站步骤：")]),t._v(" "),r("ol",[r("li",[t._v("上传网站代码")]),t._v(" "),r("li",[t._v("绑定域名（非必要）")]),t._v(" "),r("li",[t._v("新增站点配置或修改示例站点配置")]),t._v(" "),r("li",[t._v("增加网站对应的数据库（非必要）")]),t._v(" "),r("li",[t._v("进入安装向导")])]),t._v(" "),r("h2",{attrs:{id:"virtualhost"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#virtualhost","aria-hidden":"true"}},[t._v("#")]),t._v(" VirtualHost")]),t._v(" "),r("p",[t._v("VirtualHost 改动务必准确无误，任何错误的修改都会导致服务器上所有的网站不可访问")]),t._v(" "),r("table",[r("thead",[r("tr",[r("th",[t._v("VirtualHost 项")]),t._v(" "),r("th",[t._v("作用说明")]),t._v(" "),r("th",[t._v("必要性")])])]),t._v(" "),r("tbody",[r("tr",[r("td",[t._v("ServerName")]),t._v(" "),r("td",[t._v("主域名")]),t._v(" "),r("td",[t._v("必须填写")])]),t._v(" "),r("tr",[r("td",[t._v("ServerAlias")]),t._v(" "),r("td",[t._v("辅域名")]),t._v(" "),r("td",[t._v("可以不填或删除")])]),t._v(" "),r("tr",[r("td",[t._v("DocumentRoot")]),t._v(" "),r("td",[t._v("网站存放目录，同下")]),t._v(" "),r("td",[t._v("务必准确无误")])]),t._v(" "),r("tr",[r("td",[t._v("Directory")]),t._v(" "),r("td",[t._v("网站存放目录，同上")]),t._v(" "),r("td",[t._v("务必准确无误")])]),t._v(" "),r("tr",[r("td",[t._v("ErrorLog")]),t._v(" "),r("td",[t._v("错误日志路径，系统会根据定义的路径产生相关日志文件")]),t._v(" "),r("td",[t._v("可以不填或删除")])]),t._v(" "),r("tr",[r("td",[t._v("CustomLog")]),t._v(" "),r("td",[t._v("访问日志路径，系统会根据定义的路径产生相关日志文件")]),t._v(" "),r("td",[t._v("可以不填或删除")])])])]),t._v(" "),r("h2",{attrs:{id:"常见问题"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#常见问题","aria-hidden":"true"}},[t._v("#")]),t._v(" 常见问题")]),t._v(" "),r("h4",{attrs:{id:"访问刚安装的网站，页面显示-“没有权限-”-？"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#访问刚安装的网站，页面显示-“没有权限-”-？","aria-hidden":"true"}},[t._v("#")]),t._v(" 访问刚安装的网站，页面显示 “没有权限...” ？")]),t._v(" "),r("p",[t._v("运行一条修改文件权限的命令")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v("chown -R apache.apache /data/wwwroot\n")])])]),r("h4",{attrs:{id:"修改-vhost-conf-文件之后，apache-服务无法启动？"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#修改-vhost-conf-文件之后，apache-服务无法启动？","aria-hidden":"true"}},[t._v("#")]),t._v(" 修改 vhost.conf 文件之后，Apache 服务无法启动？")]),t._v(" "),r("p",[t._v("一般是 VirtualHost 中虚拟主机的目录位置不正确导致")]),t._v(" "),r("h4",{attrs:{id:"新增网站不可访问，且导致其他网站都不可访问？"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#新增网站不可访问，且导致其他网站都不可访问？","aria-hidden":"true"}},[t._v("#")]),t._v(" 新增网站不可访问，且导致其他网站都不可访问？")]),t._v(" "),r("p",[t._v("一般是 VirtualHost 中虚拟主机的目录位置不正确导致 Apache 无法启动")]),t._v(" "),r("h4",{attrs:{id:"打开新增的网站，显示404错误？"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#打开新增的网站，显示404错误？","aria-hidden":"true"}},[t._v("#")]),t._v(" 打开新增的网站，显示404错误？")]),t._v(" "),r("p",[t._v("一般是网站目录下没有 index.php 或 index.html 等默认首页导致")]),t._v(" "),r("h4",{attrs:{id:"新增的网站，显示-500-internal-server-error？"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#新增的网站，显示-500-internal-server-error？","aria-hidden":"true"}},[t._v("#")]),t._v(" 新增的网站，显示 500 Internal Server Error？")]),t._v(" "),r("p",[t._v("程序代码错误，需要查看程序的日志文件")])])},[],!1,null,null,null);a.default=s.exports}}]);