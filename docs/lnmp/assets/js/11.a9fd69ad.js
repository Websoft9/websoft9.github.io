(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{198:function(e,t,a){"use strict";a.r(t);var o=a(0),i=Object(o.a)({},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"deploy-a-php-application"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deploy-a-php-application","aria-hidden":"true"}},[e._v("#")]),e._v(" Deploy a PHP application")]),e._v(" "),a("p",[e._v("To deploy PHP application on LEMP, you need to add "),a("strong",[e._v("server{ }")]),e._v(" for it")]),e._v(" "),a("p",[e._v("Overall, just need two steps:")]),e._v(" "),a("ol",[a("li",[e._v("Upload source codes of applicaiton")]),e._v(" "),a("li",[e._v("Add new VirtualHost in the file "),a("router-link",{attrs:{to:"/stack-components.html#nginx"}},[e._v("Nginx vhost configuration file")])],1)]),e._v(" "),a("blockquote",[a("p",[a("strong",[e._v("server{ }")]),e._v(" is vhost configuration segment. Each application must correspond to a unique "),a("strong",[e._v("server{ }")]),e._v(" in "),a("strong",[e._v("default.conf")]),e._v(".")])]),e._v(" "),a("h2",{attrs:{id:"prepare"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prepare","aria-hidden":"true"}},[e._v("#")]),e._v(" Prepare")]),e._v(" "),a("p",[e._v("To deploy PHP application on LEMP, you need to know the followings:")]),e._v(" "),a("ul",[a("li",[a("strong",[e._v("Vhost Configuration File")]),e._v(": "),a("em",[e._v("/etc/nginx/conf.d/default.conf")])]),e._v(" "),a("li",[a("strong",[e._v("Tools")]),e._v(": Using WinSCP to mange files and run command")]),e._v(" "),a("li",[a("strong",[e._v("Domain Name")]),e._v(": If you want to use Domain you must complete the Domain revolution before")]),e._v(" "),a("li",[a("strong",[e._v("Database")]),e._v(": If the database can't be created automatically during the installation process, please use "),a("router-link",{attrs:{to:"/admin-mysql.html"}},[e._v("phpMyAdmin")]),e._v(" to manage it")],1)]),e._v(" "),a("p",[e._v("Once you have a overall, you can start you application deployment now")]),e._v(" "),a("h2",{attrs:{id:"deploy-fisrt-application"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deploy-fisrt-application","aria-hidden":"true"}},[e._v("#")]),e._v(" Deploy fisrt application")]),e._v(" "),a("p",[e._v("There is a example application in LEMP, we sugget you to "),a("strong",[e._v("replace the example application")]),e._v(" for deploy first application:")]),e._v(" "),a("ol",[a("li",[e._v("Use WinSCP to connect Cloud Server,")]),e._v(" "),a("li",[e._v("Delete all files in the folder "),a("em",[e._v("/data/wwwroot/www.example.com")]),e._v(", but don't delete "),a("em",[e._v("www.example.com")])]),e._v(" "),a("li",[e._v("Upload your application's codes to the folder: "),a("em",[e._v("/data/wwwroot/www.example.com")]),e._v(" "),a("img",{attrs:{src:"https://libs.websoft9.com/Websoft9/DocsPicture/en/winscp/winscp-uploadcodestoexample-websoft9.png",alt:""}})]),e._v(" "),a("li",[e._v("Modify the  "),a("code",[e._v("server{...}")]),e._v(" segment ("),a("router-link",{attrs:{to:"/solution-deployment.html#server"}},[e._v("refer to")]),e._v(") in the file "),a("em",[e._v("default.conf")]),e._v(" if you want to bind domain or modify folder name\n"),a("img",{attrs:{src:"https://libs.websoft9.com/Websoft9/DocsPicture/en/lamp/lamp-editvhostconf-websoft9.png",alt:""}}),a("div",{staticClass:"warning custom-block"},[a("p",[e._v("If you do not bind the domain and do not modify the directory name, skip steps 4 and 5.")])])],1),e._v(" "),a("li",[e._v("Save the file "),a("em",[e._v("default.conf")]),e._v(" and then Restart Nginx Service"),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("sudo systemctl restart nginx\n")])])])]),e._v(" "),a("li",[e._v("Using the Chrome or Firefox to visit: "),a("em",[e._v("http://domain")]),e._v(" or "),a("em",[e._v("http://IP/mysite2")]),e._v(" to visit your application")])]),e._v(" "),a("h2",{attrs:{id:"deploy-second-application"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deploy-second-application","aria-hidden":"true"}},[e._v("#")]),e._v(" Deploy second application")]),e._v(" "),a("p",[e._v("Start to deploy the second application, you should add new "),a("code",[e._v("server{...}")]),e._v(" segment to "),a("em",[e._v("default.conf")])]),e._v(" "),a("ol",[a("li",[a("p",[e._v('Connect Cloud Server, then create a new folder named "mysite2" to the directory '),a("em",[e._v("/data/wwwroot")]),e._v(" "),a("img",{attrs:{src:"https://libs.websoft9.com/Websoft9/DocsPicture/en/lamp/lamp-createmysite2-websoft9.png",alt:""}})])]),e._v(" "),a("li",[a("p",[e._v("Upload your application's codes to the folder: "),a("em",[e._v("/data/wwwroot/mysite2")]),e._v(" "),a("img",{attrs:{src:"https://libs.websoft9.com/Websoft9/DocsPicture/en/lamp/lamp-uploadcodes-websoft9.png",alt:""}})])]),e._v(" "),a("li",[a("p",[e._v("Edite the file "),a("em",[e._v("default.conf")]),e._v(" "),a("img",{attrs:{src:"https://libs.websoft9.com/Websoft9/DocsPicture/en/lamp/lamp-editvhostconf-websoft9.png",alt:""}})]),e._v(" "),a("p",[e._v("Have domain or no domain, Choose one of the options below:")]),e._v(" "),a("ul",[a("li",[a("strong",[e._v("Have domain, you can visit application by "),a("em",[e._v("http://domain/")])])])]),e._v(" "),a("p",[e._v("Please copy the "),a("strong",[e._v("server{ }")]),e._v(" below to "),a("em",[e._v("default.conf")]),e._v(", and modify the "),a("strong",[e._v("server_name, root, error_log, access_log")]),e._v(" and so on ("),a("router-link",{attrs:{to:"/solution-deployment.html#server"}},[e._v("refer to")]),e._v(")")],1),e._v(" "),a("pre",[a("code",[e._v("```\nserver\n{\n listen 80;\n server_name mysite2.yourdomain.com;\n index index.html index.htm index.php;\n root  /data/wwwroot/mysite2;\n error_log /var/log/nginx/mysite2.yourdomain.com-error.log crit;\n access_log  /var/log/nginx/mysite2.yourdomain.com-access.log;\n include conf.d/extra/*.conf;\n\n ## Includes one of your Rewrite rules if you need, examples\n # include conf.d/rewrite/wordpress.conf;\n # include conf.d/rewrite/joomla.conf;\n }\n ```\n")])]),e._v(" "),a("ul",[a("li",[a("strong",[e._v("No domain, you can visit application by "),a("em",[e._v("http://mysite1.yourdomain.com/mysite2")])])])]),e._v(" "),a("p",[e._v("Please copy the "),a("strong",[e._v("Alias template")]),e._v(" below to "),a("em",[e._v("default.conf")]),e._v(", and modify the "),a("strong",[e._v("/path, Directory")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("location /mysite2\n{\n alias /data/wwwroot/mysite2;\n index index.php index.html;\n location ~ ^/mysite2/.+\\.php$ {\n  alias /data/wwwroot/mysite2;\n  fastcgi_pass  unix:/dev/shm/php-fpm-default.sock;\n  fastcgi_index  index.php;\n  fastcgi_param  SCRIPT_FILENAME /data/wwwroot/$fastcgi_script_name;\n  include        fastcgi_params; }\ninclude conf.d/extra/*.conf;\n}\n")])])]),a("p",[a("img",{attrs:{src:"https://libs.websoft9.com/Websoft9/DocsPicture/en/lnmp/lnmp-insertalias-websoft9.png",alt:""}})])]),e._v(" "),a("li",[a("p",[e._v("Save the file "),a("em",[e._v("default.conf")]),e._v(" and then Restart Nginx Service")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("systemctl restart nginx\n")])])])]),e._v(" "),a("li",[a("p",[e._v("Using the Chrome or Firefox to visit: "),a("em",[e._v("http://domain")]),e._v(" or "),a("em",[e._v("http://mysite1.yourdomain.com/mysite2")]),e._v(" to visit your application")])])]),e._v(" "),a("h2",{attrs:{id:"deploy-more-application"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deploy-more-application","aria-hidden":"true"}},[e._v("#")]),e._v(" Deploy more application")]),e._v(" "),a("p",[a("strong",[e._v("Deploy more application")]),e._v(" is the same with "),a("strong",[e._v("Deploy second application")])]),e._v(" "),a("p",[e._v("Finally, we know the new and summarize the steps of the LEMP deployment site:")]),e._v(" "),a("ol",[a("li",[e._v("Upload the website code")]),e._v(" "),a("li",[e._v("Dmain name resolution(not necessary)")]),e._v(" "),a("li",[e._v("Add the site configuration or modify the sample site configuration")]),e._v(" "),a("li",[e._v("Increase the database corresponding to the site (not necessary)")]),e._v(" "),a("li",[e._v("Enter the installation wizard")])]),e._v(" "),a("h2",{attrs:{id:"server"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#server","aria-hidden":"true"}},[e._v("#")]),e._v(" Server")]),e._v(" "),a("p",[e._v("All items in the "),a("strong",[e._v("server{}")]),e._v(" must be correct, any error may cause Nginx can't start and applicaiton not accessible")]),e._v(" "),a("table",[a("thead",[a("tr",[a("th",[e._v("Server Item")]),e._v(" "),a("th",[e._v("Use")]),e._v(" "),a("th",[e._v("Necessity")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[e._v("server_name")]),e._v(" "),a("td",[e._v("domain name, if you configure two domain names, separate them with spaces.")]),e._v(" "),a("td",[e._v("Required")])]),e._v(" "),a("tr",[a("td",[e._v("root")]),e._v(" "),a("td",[e._v("The real website storage directory")]),e._v(" "),a("td",[e._v("Required and must be correct")])]),e._v(" "),a("tr",[a("td",[e._v("error_log")]),e._v(" "),a("td",[e._v("error logs directory")]),e._v(" "),a("td",[e._v("Suggestion")])]),e._v(" "),a("tr",[a("td",[e._v("access_log")]),e._v(" "),a("td",[e._v("visit logs directory")]),e._v(" "),a("td",[e._v("Suggestion")])]),e._v(" "),a("tr",[a("td",[e._v("ssl_certificate")]),e._v(" "),a("td",[e._v("HTTPS certificate directory")]),e._v(" "),a("td",[e._v("Required when using HTTPS")])]),e._v(" "),a("tr",[a("td",[e._v("ssl_certificate_key")]),e._v(" "),a("td",[e._v("HTTPS certificate key directory")]),e._v(" "),a("td",[e._v("Required when using HTTPS")])])])]),e._v(" "),a("h2",{attrs:{id:"q-a"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#q-a","aria-hidden":"true"}},[e._v("#")]),e._v(" Q&A")]),e._v(" "),a("h4",{attrs:{id:"visit-my-application-dispaly-no-permission-error"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#visit-my-application-dispaly-no-permission-error","aria-hidden":"true"}},[e._v("#")]),e._v(' Visit my application, dispaly "no permission..." error?')]),e._v(" "),a("p",[e._v("Run the this command")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("chown -R nginx.nginx /data/wwwroot\n")])])]),a("h4",{attrs:{id:"i-can-t-restart-nginx-service-after-modify-the-default-conf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#i-can-t-restart-nginx-service-after-modify-the-default-conf","aria-hidden":"true"}},[e._v("#")]),e._v(" I can't restart Nginx service after modify the "),a("em",[e._v("default.conf")]),e._v("?")]),e._v(" "),a("p",[e._v("Check the application directory items in the segement of your "),a("em",[e._v("server{ }")])]),e._v(" "),a("h4",{attrs:{id:"i-can-t-visit-my-new-deployment-and-all-applications-on-my-server"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#i-can-t-visit-my-new-deployment-and-all-applications-on-my-server","aria-hidden":"true"}},[e._v("#")]),e._v(" I can't visit my new deployment and all applications on my Server")]),e._v(" "),a("p",[e._v("Check the application directory items in the segement of your "),a("em",[e._v("server{ }")])]),e._v(" "),a("h4",{attrs:{id:"_404-error"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_404-error","aria-hidden":"true"}},[e._v("#")]),e._v(" 404 error?")]),e._v(" "),a("p",[e._v("Please make sure that the "),a("em",[e._v("index.php")]),e._v(" or "),a("em",[e._v("index.html")]),e._v(" was included in the your application's direcotory")]),e._v(" "),a("h4",{attrs:{id:"_500-internal-server-error？"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_500-internal-server-error？","aria-hidden":"true"}},[e._v("#")]),e._v(" 500 Internal Server Error？")]),e._v(" "),a("p",[e._v("The program code is wrong, you need to analyze the program's log file.")])])},[],!1,null,null,null);t.default=i.exports}}]);