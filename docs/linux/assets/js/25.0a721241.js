(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{198:function(t,a,e){"use strict";e.r(a);var r=e(0),s=Object(r.a)({},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"nginx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nginx","aria-hidden":"true"}},[t._v("#")]),t._v(" Nginx")]),t._v(" "),e("p",[t._v("以Nginx在云服务器上最常见的应用场景为切入点，结合具体的操作，让没有基础的用户也能够快速上手。")]),t._v(" "),e("p",[t._v("Nginx公司还有企业级的商业产品：\nNGINX Plus\nNGINX Controller\nNGINX Unit\nNGINX Amplify\nNGINX WAF")]),t._v(" "),e("h2",{attrs:{id:"安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装","aria-hidden":"true"}},[t._v("#")]),t._v(" 安装")]),t._v(" "),e("p",[t._v("安装Nginx有在线安装和源码编译安装两种方式，在线安装通常称之为yum安装，源码安装即需要下载源码然后进行编译后方可使用。")]),t._v(" "),e("p",[t._v("在线安装非常简单，下面是在线安装的范例：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("# Installing on Fedora/CentOS/Red Hat Enterprise Linux\nsudo yum install httpd\nsudo systemctl enable httpd\nsudo systemctl start httpd\n\n# Installing on Ubuntu/Debian\nsudo apt install apache2\nsudo service apache2 start\n")])])]),e("h2",{attrs:{id:"模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#模块","aria-hidden":"true"}},[t._v("#")]),t._v(" 模块")]),t._v(" "),e("p",[t._v("Nginx是模块化的设计，安装模块：")]),t._v(" "),e("h3",{attrs:{id:"安装模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装模块","aria-hidden":"true"}},[t._v("#")]),t._v(" 安装模块")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("# Installing on Fedora/CentOS/Red Hat Enterprise Linux\n\n\n# Installing on Ubuntu/Debian\n\n")])])]),e("h3",{attrs:{id:"查询模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查询模块","aria-hidden":"true"}},[t._v("#")]),t._v(" 查询模块")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("~"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# nginx -V")]),t._v("\nnginx version: nginx/1.12.2\nbuilt by gcc "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.8")]),t._v(".5 "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("20150623")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Red Hat "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("4.8")]),t._v(".5-16"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("GCC"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nbuilt with OpenSSL "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v(".2k-fips  "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v(" Jan "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),t._v("\nTLS SNI support enabled\nconfigure arguments: \n--prefix"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/share/nginx --sbin-path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/sbin/nginx --modules-path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/usr/lib64/nginx/modules --conf-path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/etc/nginx/nginx.conf --error-log-path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/log/nginx/error.log --http-log-path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/log/nginx/access.log --http-client-body-temp-path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/lib/nginx/tmp/client_body --http-proxy-temp-path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/lib/nginx/tmp/proxy --http-fastcgi-temp-path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/lib/nginx/tmp/fastcgi --http-uwsgi-temp-path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/lib/nginx/tmp/uwsgi --http-scgi-temp-path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/var/lib/nginx/tmp/scgi --pid-path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/run/nginx.pid --lock-path"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/run/lock/subsys/nginx --user"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nginx --group"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("nginx --with-file-aio --with-ipv6 --with-http_auth_request_module --with-http_ssl_module --with-http_v2_module --with-http_realip_module --with-http_addition_module --with-http_xslt_module"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("dynamic --with-http_image_filter_module"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("dynamic --with-http_geoip_module"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("dynamic --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_degradation_module --with-http_slice_module --with-http_stub_status_module --with-http_perl_module"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("dynamic --with-mail"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("dynamic --with-mail_ssl_module --with-pcre --with-pcre-jit --with-stream"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("dynamic --with-stream_ssl_module --with-google_perftools_module --with-debug --with-cc-opt"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -m64 -mtune=generic'")]),t._v(" --with-ld-opt"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'-Wl,-z,relro -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -Wl,-E'")]),t._v("\n")])])]),e("h2",{attrs:{id:"更新"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#更新","aria-hidden":"true"}},[t._v("#")]),t._v(" 更新")]),t._v(" "),e("h2",{attrs:{id:"请求处理机制"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#请求处理机制","aria-hidden":"true"}},[t._v("#")]),t._v(" 请求处理机制")]),t._v(" "),e("p",[t._v("Nginx有三种可选的并行处理机制：多进程方式、多线程方式和异步方式")]),t._v(" "),e("h2",{attrs:{id:"语言支持"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#语言支持","aria-hidden":"true"}},[t._v("#")]),t._v(" 语言支持")]),t._v(" "),e("h3",{attrs:{id:"php"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#php","aria-hidden":"true"}},[t._v("#")]),t._v(" PHP")]),t._v(" "),e("p",[t._v("Nginx默认不支持PHP，需要搭配php-fmp使用")]),t._v(" "),e("h3",{attrs:{id:"java"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#java","aria-hidden":"true"}},[t._v("#")]),t._v(" Java")]),t._v(" "),e("p",[t._v("Nginx需要搭配Tomcat来运行Java程序")]),t._v(" "),e("h3",{attrs:{id:"python"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#python","aria-hidden":"true"}},[t._v("#")]),t._v(" Python")]),t._v(" "),e("h3",{attrs:{id:"node-js"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#node-js","aria-hidden":"true"}},[t._v("#")]),t._v(" Node.js")]),t._v(" "),e("h3",{attrs:{id:"go"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#go","aria-hidden":"true"}},[t._v("#")]),t._v(" Go")]),t._v(" "),e("h3",{attrs:{id:"ruby"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ruby","aria-hidden":"true"}},[t._v("#")]),t._v(" Ruby")]),t._v(" "),e("h2",{attrs:{id:"伪静态"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#伪静态","aria-hidden":"true"}},[t._v("#")]),t._v(" 伪静态")]),t._v(" "),e("p",[t._v("使用伪静态有三个步骤：")]),t._v(" "),e("ol",[e("li",[t._v("确保Rewrite模块（apache模块配置文件：/etc/httpd/conf.modules.d/00-base.conf）已经被加载（去掉LoadModule rewrite_module modules/mod_rewrite.so前面的#）。")]),t._v(" "),e("li",[t._v("虚拟主机配置文件中增加AllowOverride All")]),t._v(" "),e("li",[t._v("网站根目录中增加.htaccess文件，并配置伪静态规则")])]),t._v(" "),e("h3",{attrs:{id:"重定向"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#重定向","aria-hidden":"true"}},[t._v("#")]),t._v(" 重定向")]),t._v(" "),e("ol",[e("li",[t._v("开启Apache的rewrite模块")]),t._v(" "),e("li",[t._v("在网站根目录中增加.htaccess文件")])]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[t._v("\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("IfModule mod_rewrite.c"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\nRewriteEngine On\nRedirect "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("301")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/empirecmsall-image-guide"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/xdocs/empirecms-image-guide"')]),t._v("\nRedirect "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("301")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/wordpress-image-guide"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/xdocs/wordpressold-image-guide"')]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("/IfModule"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n\n")])])]),e("h3",{attrs:{id:"隐藏后缀名"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#隐藏后缀名","aria-hidden":"true"}},[t._v("#")]),t._v(" 隐藏后缀名")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("<IfModule mod_rewrite.c>\nRewriteRule ^test$ test.php\nErrorDocument 404 /404.txt\n\n</IfModule>\n\n")])])]),e("h2",{attrs:{id:"virtualhost配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#virtualhost配置","aria-hidden":"true"}},[t._v("#")]),t._v(" VirtualHost配置")]),t._v(" "),e("h3",{attrs:{id:"http-virtualhost-template"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http-virtualhost-template","aria-hidden":"true"}},[t._v("#")]),t._v(" HTTP VirtualHost template")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('<VirtualHost *:80>\nServerName www.mydomain.com\nServerAlias other.mydomain.com\nDocumentRoot "/data/wwwroot/zdoo"\nErrorLog "/var/log/httpd/www.mydomain.com_error_apache.log"\nCustomLog "/var/log/httpd/www.mydomain.com_apache.log" common\n<Directory "/data/wwwroot/zdoo">\nOptions Indexes FollowSymlinks\nAllowOverride All\nRequire all granted\n</Directory>\n</VirtualHost>\n')])])]),e("h3",{attrs:{id:"apache-alias-template"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#apache-alias-template","aria-hidden":"true"}},[t._v("#")]),t._v(" Apache Alias template")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('Alias /path /data/wwwroot/zdoo\n<Directory "/data/wwwroot/zdoo">\nOptions Indexes FollowSymlinks\nAllowOverride All\nRequire all granted\n</Directory>\n')])])]),e("h3",{attrs:{id:"apache-https-virtualhost-template"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#apache-https-virtualhost-template","aria-hidden":"true"}},[t._v("#")]),t._v(" Apache HTTPS VirtualHost template")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('<VirtualHost *:443>\nServerName  www.mydomain.com\nDocumentRoot "/data/wwwroot/zdoo"\n#ErrorLog "logs/www.mydomain.com-error_log"\n#CustomLog "logs/www.mydomain.com-access_log" common\n<Directory "/data/wwwroot/zdoo">\nOptions Indexes FollowSymlinks\nAllowOverride All\nRequire all granted\n</Directory>\nSSLEngine on\nSSLCertificateFile  /data/cert/www.mydomain.com.crt\nSSLCertificateKeyFile  /data/cert/www.mydomain.com.key\nSSLCertificateChainFile  /data/cert/root_bundle.crt\n</VirtualHost>\n')])])]),e("h3",{attrs:{id:"默认首页名称顺序"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#默认首页名称顺序","aria-hidden":"true"}},[t._v("#")]),t._v(" 默认首页名称顺序")]),t._v(" "),e("p",[t._v("默认访问目录之时，系统会自动根据顺序寻找列出的页面，并显示其中一个。")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('<VirtualHost *:80>\nServerName win.websoft9.com\n<IfModule dir_module>\n  DirectoryIndex index.hmtl defalut.html README.html readme.html about.html\n</IfModule>\nDocumentRoot "/data/wwwroot/default/site"\n...\n')])])]),e("h3",{attrs:{id:"禁用ip访问-防止恶意解析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#禁用ip访问-防止恶意解析","aria-hidden":"true"}},[t._v("#")]),t._v(" 禁用IP访问,防止恶意解析")]),t._v(" "),e("hr"),t._v(" "),e("ol",[e("li",[t._v("给指定网站程序设置域名")]),t._v(" "),e("li",[t._v("将一下内容加入 "),e("code",[t._v("/etc/httpd/conf/httpd.conf")]),t._v(" 的末尾或者在 "),e("code",[t._v("/etc/httpd/conf.d/")]),t._v(" 目录下新建一个 "),e("code",[t._v("deny-ip.conf")]),t._v("的文件将内容写入"),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("<VirtualHost *:80>\n  ServerName 服务器IP地址\n  <Location />\n       Order Allow,Deny\n       Deny from all\n  </Location>\n</VirtualHost>\n\n<VirtualHost *:443>\n   ServerName 服务器IP地址\n   SSLEngine on\n   SSLCertificateFile /etc/pki/tls/certs/localhost.crt\n   SSLCertificateKeyFile /etc/pki/tls/private/localhost.key\n   <Location />\n     Order Allow,Deny\n     Deny from all\n   </Location>\n</VirtualHost>\n")])])])]),t._v(" "),e("li",[t._v("重启 apache\n"),e("code",[t._v("systemctl restart httpd")])])]),t._v(" "),e("h2",{attrs:{id:"代理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#代理","aria-hidden":"true"}},[t._v("#")]),t._v(" 代理")]),t._v(" "),e("h2",{attrs:{id:"服务启停"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#服务启停","aria-hidden":"true"}},[t._v("#")]),t._v(" 服务启停")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("#CentOS or Redhat\nsystemctl start httpd\nsystemctl stop httpd\nsystemctl restart httpd\nsystemctl status httpd\n\n# Ubutnu\nsystemctl start apache2\nsystemctl stop apache2\nsystemctl restart apache2\nsystemctl status apache2\n")])])]),e("h2",{attrs:{id:"日志"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#日志","aria-hidden":"true"}},[t._v("#")]),t._v(" 日志")]),t._v(" "),e("h2",{attrs:{id:"缓存"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#缓存","aria-hidden":"true"}},[t._v("#")]),t._v(" 缓存")])])},[],!1,null,null,null);a.default=s.exports}}]);